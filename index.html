<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pong</title>
   <link rel="icon" href="data:," />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.min.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      touch-action: none;
    }
    #controls {
      position: fixed;
      bottom: 10px;
      width: 100%;
      text-align: center;
      z-index: 10;
    }
    .btn {
      background: white;
      border: none;
      padding: 20px;
      margin: 5px;
      font-size: 24px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

<div id="controls">
  <button class="btn" ontouchstart="moveUp()" ontouchend="stopMove()">⬆️</button>
  <button class="btn" ontouchstart="moveDown()" ontouchend="stopMove()">⬇️</button>
</div>

<script>
let playerY, aiY, ballX, ballY, ballSpeedX, ballSpeedY;
let playerScore = 0;
let verseIndex = 0;
let showVerse = false;
let verseTimer = 0;
let moving = 0;

let bounceSound, pointSound;
let soundEnabled = false;

const verses = [
  "Todo lo puedo en Cristo que me fortalece. (Filipenses 4:13)",
  "Jehová es mi pastor; nada me faltará. (Salmo 23:1)",
  "El Señor es mi luz y mi salvación. (Salmo 27:1)",
  "Esforzaos y cobrad ánimo. (Deuteronomio 31:6)",
  "Con Dios haremos proezas. (Salmo 60:12)"
];

function preload() {
  bounceSound = loadSound('https://cdn.jsdelivr.net/gh/terkelg/spaceinvaders-sounds/fastinvader1.wav');
  pointSound = loadSound('https://cdn.jsdelivr.net/gh/terkelg/spaceinvaders-sounds/explosion.wav');
}

function setup() {
  createCanvas(window.innerWidth, window.innerHeight - 110); // Ajustado para controles
  playerY = height / 2;
  aiY = height / 2;
  ballX = width / 2;
  ballY = height / 2;
  ballSpeedX = 5;
  ballSpeedY = 3;
  textAlign(CENTER, CENTER);
}

function draw() {
  background(0);

  // Paletas
  rect(30, playerY, 10, 80); // Jugador
  rect(width - 40, aiY, 10, 80); // IA

  // Pelota
  ellipse(ballX, ballY, 20);

  // Movimiento jugador
  playerY += moving * 7;
  playerY = constrain(playerY, 0, height - 80);

  // Movimiento IA
  aiY += (ballY - aiY - 40) * 0.05;

  // Movimiento pelota
  ballX += ballSpeedX;
  ballY += ballSpeedY;

  // Rebote vertical
  if (ballY <= 0 || ballY >= height) {
    ballSpeedY *= -1;
    if (soundEnabled) bounceSound.play();
  }

  // Rebote jugador
  if (ballX < 40 && ballY > playerY && ballY < playerY + 80) {
    ballSpeedX *= -1;
    if (soundEnabled) bounceSound.play();
  }

  // Rebote IA
  if (ballX > width - 50 && ballY > aiY && ballY < aiY + 80) {
    ballSpeedX *= -1;
    if (soundEnabled) bounceSound.play();
  }

  // Punto para jugador
  if (ballX > width) {
    playerScore++;
    if (soundEnabled) pointSound.play();
    checkVerse();
    resetBall();
  }

  // Punto para IA
  if (ballX < 0) {
    resetBall();
  }

  // Puntos y versículo
  fill(255);
  textSize(32);
  text(`Puntos: ${playerScore}`, width / 2, 30);

  if (showVerse) {
    textSize(18);
    text(verses[verseIndex], width / 2, height - 60);
    verseTimer--;
    if (verseTimer <= 0) showVerse = false;
  }
}

function resetBall() {
  ballX = width / 2;
  ballY = height / 2;
  ballSpeedX = -ballSpeedX;
  ballSpeedY = random(-3, 3);
}

function checkVerse() {
  if (playerScore % 5 === 0) {
    showVerse = true;
    verseTimer = 300;
    verseIndex = (verseIndex + 1) % verses.length;
  }
}

// Eventos teclado
function keyPressed() {
  soundEnabled = true;
  if (keyCode === UP_ARROW) moving = -1;
  if (keyCode === DOWN_ARROW) moving = 1;
}
function keyReleased() {
  if (keyCode === UP_ARROW || keyCode === DOWN_ARROW) moving = 0;
}

// Controles táctiles
function moveUp() {
  soundEnabled = true;
  moving = -1;
}
function moveDown() {
  soundEnabled = true;
  moving = 1;
}
function stopMove() {
  moving = 0;
}
</script>
</body>
</html>
