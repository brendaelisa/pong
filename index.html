<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pong</title>
   <link rel="icon" href="data:," />
  <style>
    body {
      margin: 0;
      background: #222;
      color: white;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    canvas {
      border: 4px solid white;
      margin-top: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Pong: 1 Jugador vs IA</h1>
  <div id="score"></div>
  <div id="verse"></div>
  <div id="timer"></div>
  <button onclick="resetGame()">Reiniciar</button>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script>
    let player, ai, ball;
    let playerScore = 0;
    let aiScore = 0;
    let verses = [
      "Todo lo puedo en Cristo que me fortalece. - Filipenses 4:13",
      "El SeÃ±or es mi pastor; nada me faltarÃ¡. - Salmo 23:1",
      "JehovÃ¡ es mi luz y mi salvaciÃ³n. - Salmo 27:1",
      "El que habita al abrigo del AltÃ­simo morarÃ¡ bajo la sombra del Omnipotente. - Salmo 91:1",
      "ConfÃ­a en el SeÃ±or con todo tu corazÃ³n. - Proverbios 3:5"
    ];
    let timerStart;
    let timeLimit = 60; // segundos
    let winner = null;

    function setup() {
      createCanvas(600, 400);
      player = new Paddle(true);
      ai = new Paddle(false);
      ball = new Ball();
      timerStart = millis();
    }

    function draw() {
      background(0);
      drawCourt();

      if (winner) {
        textSize(32);
        textAlign(CENTER, CENTER);
        fill(255);
        text(winner, width / 2, height / 2);
        noLoop();
        return;
      }

      let elapsed = int((millis() - timerStart) / 1000);
      let remaining = max(0, timeLimit - elapsed);
      document.getElementById("timer").innerText = `Tiempo restante: ${remaining}s`;
      if (remaining === 0) {
        winner = playerScore > aiScore ? "ðŸ† Â¡Ganaste!" : "ðŸ¤– Perdiste contra la IA.";
      }

      player.show();
      ai.show();
      ball.update();
      ball.show();

      player.move();
      ai.y = constrain(ball.y - ai.h / 2, 0, height - ai.h); // IA sigue la pelota

      ball.checkPaddle(player);
      ball.checkPaddle(ai);

      updateScore();
    }

    function updateScore() {
      document.getElementById("score").innerText = `Jugador: ${playerScore} | IA: ${aiScore}`;
    }

    function drawCourt() {
      stroke(255);
      strokeWeight(2);
      line(width / 2, 0, width / 2, height);
    }

    function keyPressed() {
      if (key === 'ArrowUp') player.dir = -1;
      if (key === 'ArrowDown') player.dir = 1;
    }

    function keyReleased() {
      if (key === 'ArrowUp' || key === 'ArrowDown') player.dir = 0;
    }

    function touchStarted() {
      if (touches.length > 0) {
        if (touches[0].y < height / 2) player.dir = -1;
        else player.dir = 1;
      }
    }

    function touchEnded() {
      player.dir = 0;
    }

    function resetGame() {
      playerScore = 0;
      aiScore = 0;
      winner = null;
      timerStart = millis();
      document.getElementById("verse").innerText = "";
      loop();
    }

    class Paddle {
      constructor(isLeft) {
        this.w = 10;
        this.h = 80;
        this.x = isLeft ? 10 : width - 20;
        this.y = height / 2 - this.h / 2;
        this.dir = 0;
      }

      move() {
        this.y += this.dir * 5;
        this.y = constrain(this.y, 0, height - this.h);
      }

      show() {
        fill(255);
        rect(this.x, this.y, this.w, this.h);
      }
    }

    class Ball {
      constructor() {
        this.reset();
      }

      reset() {
        this.x = width / 2;
        this.y = height / 2;
        this.r = 10;
        this.speed = 5;
        this.xspeed = random([1, -1]) * this.speed;
        this.yspeed = random(-this.speed, this.speed);
      }

      update() {
        this.x += this.xspeed;
        this.y += this.yspeed;

        if (this.y < 0 || this.y > height) this.yspeed *= -1;

        if (this.x < 0) {
          aiScore++;
          this.reset();
        } else if (this.x > width) {
          playerScore++;
          if (playerScore % 5 === 0) {
            let v = random(verses);
            document.getElementById("verse").innerText = v;
          }
          this.reset();
        }
      }

      checkPaddle(p) {
        if (
          this.x - this.r < p.x + p.w &&
          this.x + this.r > p.x &&
          this.y > p.y &&
          this.y < p.y + p.h
        ) {
          this.xspeed *= -1;
        }
      }

      show() {
        fill(255);
        ellipse(this.x, this.y, this.r * 2);
      }
    }
  </script>
</body>
</html>